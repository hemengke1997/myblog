(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{118:function(e,n,t){"use strict";t.d(n,"a",(function(){return p})),t.d(n,"b",(function(){return g}));var r=t(0),o=t.n(r);function c(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){c(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},c=Object.keys(e);for(r=0;r<c.length;r++)t=c[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)t=c[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var l=o.a.createContext({}),b=function(e){var n=o.a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},p=function(e){var n=b(e.components);return o.a.createElement(l.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return o.a.createElement(o.a.Fragment,{},n)}},d=o.a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,c=e.originalType,a=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),p=b(t),d=r,g=p["".concat(a,".").concat(d)]||p[d]||u[d]||c;return t?o.a.createElement(g,i(i({ref:n},l),{},{components:t})):o.a.createElement(g,i({ref:n},l))}));function g(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var c=t.length,a=new Array(c);a[0]=d;var i={};for(var s in n)hasOwnProperty.call(n,s)&&(i[s]=n[s]);i.originalType=e,i.mdxType="string"==typeof e?e:r,a[1]=i;for(var l=2;l<c;l++)a[l]=t[l];return o.a.createElement.apply(null,a)}return o.a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},119:function(e,n,t){"use strict";t.d(n,"b",(function(){return c})),t.d(n,"a",(function(){return a}));var r=t(22),o=t(120);function c(){const{siteConfig:{baseUrl:e="/",url:n}={}}=Object(r.default)();return{withBaseUrl:(t,r)=>function(e,n,t,{forcePrependBaseUrl:r=!1,absolute:c=!1}={}){if(!t)return t;if(t.startsWith("#"))return t;if(Object(o.b)(t))return t;if(r)return n+t;const a=t.startsWith(n)?t:n+t.replace(/^\//,"");return c?e+a:a}(n,e,t,r)}}function a(e,n={}){const{withBaseUrl:t}=c();return t(e,n)}},120:function(e,n,t){"use strict";function r(e){return!0===/^(\w*:|\/\/)/.test(e)}function o(e){return void 0!==e&&!r(e)}t.d(n,"b",(function(){return r})),t.d(n,"a",(function(){return o}))},95:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return a})),t.d(n,"metadata",(function(){return i})),t.d(n,"toc",(function(){return s})),t.d(n,"default",(function(){return b}));var r=t(3),o=(t(0),t(118)),c=t(119);const a={title:"\u4e0d\u6b62\u662f\u56fe\u7247\u61d2\u52a0\u8f7d",id:"notOnlyLazyLoadImage"},i={unversionedId:"frontEnd/notOnlyLazyLoadImage",id:"frontEnd/notOnlyLazyLoadImage",isDocsHomePage:!1,title:"\u4e0d\u6b62\u662f\u56fe\u7247\u61d2\u52a0\u8f7d",description:"2021\u5e74\u4e86\uff0c\u4e0d\u4f1a\u8fd8\u5728\u7528scrollTop\u3001getBoundingClientRect\u8fd9\u4e9bAPI\u6765\u5224\u65ad\u56fe\u7247\u662f\u5426\u8fdb\u5165\u53ef\u89c6\u533a\u57df\u5427\uff1f",source:"@site/docs\\frontEnd\\\u4e0d\u6b62\u662f\u56fe\u7247\u61d2\u52a0\u8f7d.md",slug:"/frontEnd/notOnlyLazyLoadImage",permalink:"/myblog/docs/frontEnd/notOnlyLazyLoadImage",editUrl:"https://github.com/hemengke1997/myblog/blob/master/docs\\frontEnd\\\u4e0d\u6b62\u662f\u56fe\u7247\u61d2\u52a0\u8f7d.md",version:"current",lastUpdatedBy:"\u8d3a\u68a6\u67ef",lastUpdatedAt:1609123472,sidebar:"docs",previous:{title:"\u6bd4\u8f83",permalink:"/myblog/docs/frontEnd/compare"},next:{title:"\u5173\u4e8e\u9879\u76ee\u5168\u5c40\u56fe\u7247\u61d2\u52a0\u8f7d\u7684\u601d\u8003",permalink:"/myblog/docs/frontEnd/thinkLazyloadImg"}},s=[{value:"\u4f7f\u7528IntersectionObserver\u5b9e\u73b0\u65e0\u9650\u6eda\u52a8",id:"\u4f7f\u7528intersectionobserver\u5b9e\u73b0\u65e0\u9650\u6eda\u52a8",children:[]}],l={toc:s};function b({components:e,...n}){return Object(o.b)("wrapper",Object(r.a)({},l,n,{components:e,mdxType:"MDXLayout"}),Object(o.b)("p",null,"2021\u5e74\u4e86\uff0c\u4e0d\u4f1a\u8fd8\u5728\u7528scrollTop\u3001getBoundingClientRect\u8fd9\u4e9bAPI\u6765\u5224\u65ad\u56fe\u7247\u662f\u5426\u8fdb\u5165\u53ef\u89c6\u533a\u57df\u5427\uff1f"),Object(o.b)("h1",{id:"intersection-observer-api"},"Intersection Observer API"),Object(o.b)("p",null,"\u8fd9\u662f\u65b0\u7684\u6b66\u5668\uff0c\u7528\u4e8e\u68c0\u6d4b\u76ee\u6807\u5143\u7d20\u4e0e\u7956\u5148\u5143\u7d20\u6216\u89c6\u7a97\u7684\u76f8\u4ea4\u60c5\u51b5\u3002 \uff08\u5f02\u6b65\u7684\uff0c\u4e0d\u4f1a\u963b\u585eUI\u6e32\u67d3\uff09"),Object(o.b)("p",null,"\u4ee5\u524d\u6211\u4eec\u8981\u5224\u65ad\u4e00\u4e2a\u5143\u7d20\u662f\u5426\u53ef\u89c1\uff0c\u6216\u8005\u4e24\u4e2a\u5143\u7d20\u662f\u5426\u76f8\u4ea4\uff0c\u9700\u8981\u7528\u5230\u5404\u79cd\u5bbd\u5ea6\u9ad8\u5ea6\u4e4b\u7c7b\u7684api\uff0c\u73b0\u5728\u53ea\u9700\u8981\u8fd9\u4e2a ",Object(o.b)("inlineCode",{parentName:"p"},"intersection observer"),"\xa0\u5c31\u5168\u641e\u5b9a\u4e86\uff1a"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"\u56fe\u7247\u61d2\u52a0\u8f7d"),Object(o.b)("li",{parentName:"ul"},"\u5185\u5bb9\u65e0\u9650\u6eda\u52a8 \uff08\u600e\u4e48\u5224\u65ad\u5185\u5bb9\u5df2\u5230\u8fbe\u5e95\u90e8\uff09"),Object(o.b)("li",{parentName:"ul"},"\u68c0\u6d4b\u4e00\u4e9b\u91cd\u8981\u89c6\u56fe\u7684\u66dd\u5149\u60c5\u51b5\uff0c \u5982\u5e7f\u544a"),Object(o.b)("li",{parentName:"ul"},"\u5728\u7528\u6237\u770b\u89c1\u7684\u65f6\u5019\u518d\u53bb\u6267\u884c\u4efb\u52a1\u6216\u64ad\u653e\u52a8\u753b\uff08\u6027\u80fd\u4f18\u5316\uff09")),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},"\u8fc7\u53bb\uff0c\u76f8\u4ea4\u68c0\u6d4b\u901a\u5e38\u8981\u7528\u5230\u4e8b\u4ef6\u76d1\u542c\uff0c\u5e76\u4e14\u9700\u8981\u9891\u7e41\u8c03\u7528",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Element/getBoundingClientRect"}),Object(o.b)("inlineCode",{parentName:"a"},"Element.getBoundingClientRect()")),"\xa0\u65b9\u6cd5\u4ee5\u83b7\u53d6\u76f8\u5173\u5143\u7d20\u7684\u8fb9\u754c\u4fe1\u606f\u3002",Object(o.b)("strong",{parentName:"p"},"\u4e8b\u4ef6\u76d1\u542c\u548c\u8c03\u7528\xa0"),Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Element/getBoundingClientRect"}),Object(o.b)("strong",{parentName:"a"},Object(o.b)("inlineCode",{parentName:"strong"},"Element.getBoundingClientRect()"))),Object(o.b)("strong",{parentName:"p"},"\xa0 \u90fd\u662f\u5728\u4e3b\u7ebf\u7a0b\u4e0a\u8fd0\u884c\uff0c\u56e0\u6b64\u9891\u7e41\u89e6\u53d1\u3001\u8c03\u7528\u53ef\u80fd\u4f1a\u9020\u6210\u6027\u80fd\u95ee\u9898\u3002\u8fd9\u79cd\u68c0\u6d4b\u65b9\u6cd5\u6781\u5176\u602a\u5f02\u4e14\u4e0d\u4f18\u96c5"),"\u3002")),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"intersection observer"),"\xa0\u4e3a\u4ec0\u4e48\u66f4\u597d\u5462\uff1f"),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},"Intersection Observer API \u4f1a\u6ce8\u518c\u4e00\u4e2a\u56de\u8c03\u51fd\u6570\uff0c\u6bcf\u5f53\u88ab\u76d1\u89c6\u7684\u5143\u7d20\u8fdb\u5165\u6216\u8005\u9000\u51fa\u53e6\u5916\u4e00\u4e2a\u5143\u7d20\u65f6(\u6216\u8005\xa0",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://developer.mozilla.org/zh-CN/docs/Glossary/Viewport"}),"viewport"),"\xa0)\uff0c\u6216\u8005\u4e24\u4e2a\u5143\u7d20\u7684\u76f8\u4ea4\u90e8\u5206\u5927\u5c0f\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u8be5\u56de\u8c03\u65b9\u6cd5\u4f1a\u88ab\u89e6\u53d1\u6267\u884c\u3002\u8fd9\u6837\uff0c\u6211\u4eec\u7f51\u7ad9\u7684",Object(o.b)("strong",{parentName:"p"},"\u4e3b\u7ebf\u7a0b\u4e0d\u9700\u8981\u518d\u4e3a\u4e86\u76d1\u542c\u5143\u7d20\u76f8\u4ea4\u800c\u8f9b\u82e6\u52b3\u4f5c\uff0c\u6d4f\u89c8\u5668\u4f1a\u81ea\u884c\u4f18\u5316\u5143\u7d20\u76f8\u4ea4\u7ba1\u7406"),"\u3002")),Object(o.b)("p",null,"\u4f55\u4e3a\u76f8\u4ea4\uff1f"),Object(o.b)("img",{src:Object(c.a)("img/\u56fe\u7247\u61d2\u52a0\u8f7d1.png"),alt:""}),"## Intersection Observer \u4f7f\u7528\u65b9\u6cd5",Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-javascript"}),"// \u5b9a\u4e49\u76f8\u4ea4\u76d1\u89c6\u5668\nvar observer = new IntersectionObserver(changes => {\n  for (const change of changes) {\n    console.log(change.time);               // \u53d1\u751f\u53d8\u5316\u7684\u65f6\u95f4\n    console.log(change.rootBounds);         // \u6839\u5143\u7d20\u7684\u77e9\u5f62\u533a\u57df\u7684\u4fe1\u606f\n    console.log(change.boundingClientRect); // \u76ee\u6807\u5143\u7d20\u7684\u77e9\u5f62\u533a\u57df\u7684\u4fe1\u606f\n    console.log(change.intersectionRect);   // \u76ee\u6807\u5143\u7d20\u4e0e\u89c6\u53e3\uff08\u6216\u6839\u5143\u7d20\uff09\u7684\u4ea4\u53c9\u533a\u57df\u7684\u4fe1\u606f\n    console.log(change.intersectionRatio);  // \u76ee\u6807\u5143\u7d20\u4e0e\u89c6\u53e3\uff08\u6216\u6839\u5143\u7d20\uff09\u7684\u76f8\u4ea4\u6bd4\u4f8b\n    console.log(change.target);             // \u88ab\u89c2\u5bdf\u7684\u76ee\u6807\u5143\u7d20\n  }\n}, {});\n// \u5f00\u59cb\u89c2\u5bdf\u67d0\u4e2a\u76ee\u6807\u5143\u7d20\nobserver.observe(target);\n// \u505c\u6b62\u89c2\u5bdf\u67d0\u4e2a\u76ee\u6807\u5143\u7d20\nobserver.unobserve(target);\n// \u5173\u95ed\u76d1\u89c6\u5668\nobserver.disconnect();\n")),Object(o.b)("p",null,"\u4f7f\u7528\u65b9\u5f0f\uff1a"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-javascript"}),"const intersectionObserver = new IntersectionObserver(callback, options)\nintersectionObserver.observe(target)  // \u7ed9target\u6ce8\u518c\u76d1\u542c\n")),Object(o.b)("p",null,"\u5177\u4f53\u793a\u4f8b\uff1a"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-javascript"}),"function ob(target) {\n    const options = {\n    root: document.querySelector('#x'), // \u6839\u5143\u7d20\u3002\u5982\u679c\u4e3a\u7a7a\u65f6\uff0c\u5219\u9ed8\u8ba4\u89c6\u7a97\u3002\n    rootMargin: '0px', // \u6839\u5143\u7d20\u7684\u5916\u8fb9\u8ddd\n    threshold: 0.25, // number\u6216\u6570\u7ec4\u3002\u8868\u793atarget\u4e0eroot\u76f8\u4ea4\u7684\u6bd4\u4f8b\uff0c\u8fbe\u5230\u6bd4\u4f8b\u65f6\u5219\u89e6\u53d1\u56de\u8c03\u51fd\u6570\u3002\u82e5\u6307\u5b9a0\uff0c\u8868\u793a\u53ea\u8981\u8282\u70b9\u8fdb\u5165\u53ef\u89c6\u533a\u57df\u9a6c\u4e0a\u89e6\u53d1\u56de\u8c03\u3002\u82e5\u6307\u5b9a1\uff0c\u8868\u793a\u8282\u70b9\u5b8c\u5168\u8fdb\u5165\u53ef\u89c6\u533a\u57df\u65f6\u89e6\u53d1\u56de\u8c03\uff08\u53ef\u4ee5\u7528\u6765\u505a\u65e0\u9650\u6eda\u52a8\uff09\n  }\n  const intersectionObserver = new IntersectionObserver((entries, observer)=>{\n    entries.forEach(entry=>{\n      //   entry.boundingClientRect\n      //   entry.intersectionRatio\n      //   entry.intersectionRect\n      //   entry.isIntersecting\n      //   entry.rootBounds\n      //   entry.target\n      //   entry.time\n      if(entry.isIntersecting) {\n        // \u82e5\u76f8\u4ea4\u4e86\uff0c\u6267\u884c\u4e00\u4e9b\u4e1a\u52a1\u903b\u8f91\uff0c\u5982\u61d2\u52a0\u8f7d\n        entry.target.setAttribute('src', 'xxx')\n        ...\n        observer.disconnect()\n      }\n    })\n  }, options)\n  intersectionObserver.observer(target)\n}\n\nwindow.onload = () => {\n    const imgs = [...document.querySelector('img')]\n  imgs.forEach(img=>{\n    ob(img)\n  })\n}\n")),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},"\u8bf7\u7559\u610f\uff0c\u4f60\u6ce8\u518c\u7684\u56de\u8c03\u51fd\u6570\u5c06\u4f1a\u5728\u4e3b\u7ebf\u7a0b\u4e2d\u88ab\u6267\u884c\u3002\u6240\u4ee5\u8be5\u51fd\u6570\u6267\u884c\u901f\u5ea6\u8981\u5c3d\u53ef\u80fd\u7684\u5feb\u3002\u5982\u679c\u6709\u4e00\u4e9b\u8017\u65f6\u7684\u64cd\u4f5c\u9700\u8981\u6267\u884c\uff0c\u5efa\u8bae\u4f7f\u7528\xa0",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Window/requestIdleCallback"}),Object(o.b)("inlineCode",{parentName:"a"},"Window.requestIdleCallback()")),"\xa0\u65b9\u6cd5\u3002")),Object(o.b)("p",null,"\u517c\u5bb9\u6027\uff1a"),Object(o.b)("img",{src:Object(c.a)("img/\u56fe\u7247\u61d2\u52a0\u8f7d2.png"),alt:""}),"IE\u7403\u7403\u4f60\u505a\u4e2a\u4eba\u5427",Object(o.b)("p",null,"\u76f8\u5173\u63d2\u4ef6\uff1a\n",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/thebuilder/react-intersection-observer"}),"https://github.com/thebuilder/react-intersection-observer")),Object(o.b)("h2",{id:"\u4f7f\u7528intersectionobserver\u5b9e\u73b0\u65e0\u9650\u6eda\u52a8"},"\u4f7f\u7528IntersectionObserver\u5b9e\u73b0\u65e0\u9650\u6eda\u52a8"),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"\u5728\u9700\u8981\u65e0\u9650\u6eda\u52a8\u7684\u4e0b\u65b9\u52a0\u4e00\u4e2a\u7a7a\u76d2\u5b50\uff0c\u8fd9\u4e2a\u76d2\u5b50\u7528\u6765\u5224\u65ad\u5185\u5bb9\u662f\u5426\u6eda\u52a8\u5230\u4e86\u5e95\u90e8")),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-javascript"}),'<template>\n  <div class="outter">\n    <div class="inner"></div>\n    <div ref="inner" class="test"></div>\n  </div>\n</template>\n\n<script>\nexport default {\n  methods: {\n    createOb(target) {\n      const options = {\n        // root: document.documentElement,\n        rootMargin: "0px 0px 0px 0px", // \u5982\u679c\u9700\u8981\u4e00\u4e9b\u63d0\u524d\u91cf\uff0c\u53ef\u4ee5\u8bbe\u7f6erootMargin\n        threshold: [1]\n      };\n\n      const io = new IntersectionObserver((entries, observer) => {\n        entries.forEach((entry) => {\n          if (entry.isIntersecting) {\n            console.log("\u6eda\u52a8\u5230\u5e95\u90e8\u4e86");\n          }\n        });\n      }, options);\n\n      io.observe(target);\n    },\n  },\n  mounted() {\n    // console.log(this.$refs.inner);\n    this.createOb(this.$refs.inner);\n  },\n};\n<\/script>\n\n<style lang="less" scoped>\n.outter {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  padding: 32px;\n  .inner {\n    height: 2000px;\n    width: 100%;\n    background-color: #000;\n  }\n  .test {\n    width: 100%;\n    height: 0px;\n  }\n}\n</style>\n')),Object(o.b)("img",{src:Object(c.a)("img/\u56fe\u7247\u61d2\u52a0\u8f7d.gif"),alt:""}))}b.isMDXComponent=!0}}]);