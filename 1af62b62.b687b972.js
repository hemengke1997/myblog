(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{120:function(e,n,t){"use strict";t.d(n,"a",(function(){return p})),t.d(n,"b",(function(){return d}));var i=t(0),r=t.n(i);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,i,r=function(e,n){if(null==e)return{};var t,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)t=a[i],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)t=a[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var c=r.a.createContext({}),m=function(e){var n=r.a.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},p=function(e){var n=m(e.components);return r.a.createElement(c.Provider,{value:n},e.children)},g={inlineCode:"code",wrapper:function(e){var n=e.children;return r.a.createElement(r.a.Fragment,{},n)}},u=r.a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,a=e.originalType,o=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),p=m(t),u=i,d=p["".concat(o,".").concat(u)]||p[u]||g[u]||a;return t?r.a.createElement(d,s(s({ref:n},c),{},{components:t})):r.a.createElement(d,s({ref:n},c))}));function d(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var a=t.length,o=new Array(a);o[0]=u;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,o[1]=s;for(var c=2;c<a;c++)o[c]=t[c];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,t)}u.displayName="MDXCreateElement"},121:function(e,n,t){"use strict";t.d(n,"b",(function(){return a})),t.d(n,"a",(function(){return o}));var i=t(22),r=t(122);function a(){const{siteConfig:{baseUrl:e="/",url:n}={}}=Object(i.default)();return{withBaseUrl:(t,i)=>function(e,n,t,{forcePrependBaseUrl:i=!1,absolute:a=!1}={}){if(!t)return t;if(t.startsWith("#"))return t;if(Object(r.b)(t))return t;if(i)return n+t;const o=t.startsWith(n)?t:n+t.replace(/^\//,"");return a?e+o:o}(n,e,t,i)}}function o(e,n={}){const{withBaseUrl:t}=a();return t(e,n)}},122:function(e,n,t){"use strict";function i(e){return!0===/^(\w*:|\/\/)/.test(e)}function r(e){return void 0!==e&&!i(e)}t.d(n,"b",(function(){return i})),t.d(n,"a",(function(){return r}))},76:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return s})),t.d(n,"metadata",(function(){return l})),t.d(n,"toc",(function(){return c})),t.d(n,"default",(function(){return p}));var i=t(3),r=t(7),a=(t(0),t(120)),o=t(121),s={title:"\u5b9e\u73b0\u6398\u91d1\u7684\u56fe\u7247\u9884\u89c8",id:"juejinImageViewer"},l={unversionedId:"frontEnd/juejinImageViewer",id:"frontEnd/juejinImageViewer",isDocsHomePage:!1,title:"\u5b9e\u73b0\u6398\u91d1\u7684\u56fe\u7247\u9884\u89c8",description:"\u5148\u770b\u770b\u6398\u91d1\u7684\u56fe\u7247\u9884\u89c8\u6548\u679c",source:"@site/docs\\frontEnd\\\u5b9e\u73b0\u6398\u91d1\u7684\u56fe\u7247\u9884\u89c8.md",slug:"/frontEnd/juejinImageViewer",permalink:"/myblog/docs/frontEnd/juejinImageViewer",editUrl:"https://github.com/hemengke1997/myblog/blob/master/docs\\frontEnd\\\u5b9e\u73b0\u6398\u91d1\u7684\u56fe\u7247\u9884\u89c8.md",version:"current",lastUpdatedBy:"\u8d3a\u68a6\u67ef",lastUpdatedAt:1609146331,sidebar:"docs",previous:{title:"Docusaurus\u9759\u6001\u7f51\u7ad9\u6846\u67b6",permalink:"/myblog/docs/frontEnd/docusaurus"},next:{title:"Vue",permalink:"/myblog/docs/interview/interview"}},c=[{value:"\u5148\u770b\u770b\u6398\u91d1\u7684\u56fe\u7247\u9884\u89c8\u6548\u679c",id:"\u5148\u770b\u770b\u6398\u91d1\u7684\u56fe\u7247\u9884\u89c8\u6548\u679c",children:[]},{value:"\u5206\u6790",id:"\u5206\u6790",children:[]},{value:"\u67e5\u770b\u6398\u91d1 css",id:"\u67e5\u770b\u6398\u91d1-css",children:[]},{value:"\u6211\u7684\u7248\u672c",id:"\u6211\u7684\u7248\u672c",children:[]},{value:"\u6548\u679c\u56fe",id:"\u6548\u679c\u56fe",children:[]},{value:"\u601d\u8003",id:"\u601d\u8003",children:[]},{value:"\u5f15\u7533\uff1a \u6211\u60f3\u5728\u56fe\u7247\u9690\u85cf\u65f6\u6dfb\u52a0\u9006\u52a8\u753b",id:"\u5f15\u7533\uff1a-\u6211\u60f3\u5728\u56fe\u7247\u9690\u85cf\u65f6\u6dfb\u52a0\u9006\u52a8\u753b",children:[]},{value:"React\u7248\u672c",id:"react\u7248\u672c",children:[]}],m={toc:c};function p(e){var n=e.components,t=Object(r.a)(e,["components"]);return Object(a.b)("wrapper",Object(i.a)({},m,t,{components:n,mdxType:"MDXLayout"}),Object(a.b)("h3",{id:"\u5148\u770b\u770b\u6398\u91d1\u7684\u56fe\u7247\u9884\u89c8\u6548\u679c"},"\u5148\u770b\u770b\u6398\u91d1\u7684\u56fe\u7247\u9884\u89c8\u6548\u679c"),Object(a.b)("img",{src:Object(o.a)("img/juejinImageViewer.gif"),alt:""}),Object(a.b)("h3",{id:"\u5206\u6790"},"\u5206\u6790"),Object(a.b)("ol",null,Object(a.b)("li",{parentName:"ol"},"\u56fe\u7247\u662f\u4ece\u539f\u6765\u7684\u5730\u65b9\u79fb\u52a8\u81f3\u5c4f\u5e55\u5c45\u4e2d\uff0c\u4e14\u79fb\u52a8\u5e26\u6709\u8fc7\u6e21\u6548\u679c"),Object(a.b)("li",{parentName:"ol"},"\u56fe\u7247\u51fa\u73b0\u65f6\u6709\u8499\u5c42\u8fc7\u6e21\u6548\u679c")),Object(a.b)("h3",{id:"\u67e5\u770b\u6398\u91d1-css"},"\u67e5\u770b\u6398\u91d1 css"),Object(a.b)("img",{src:Object(o.a)("img/juejinImageViewer1.png"),alt:""}),Object(a.b)("p",null,"\u56fe\u7247\u662f\u4f7f\u7528\u7684\u7edd\u5bf9\u5b9a\u4f4d+transition:all \u5b9e\u73b0\u7684\u79fb\u52a8\u548c\u8fc7\u6e21\u6548\u679c"),Object(a.b)("img",{src:Object(o.a)("img/juejinImageViewer2.png"),alt:""}),Object(a.b)("p",null,"\u56fe\u7247\u5305\u88f9\u5c42\u4f7f\u7528\u4e86 vue \u7684 transition \u7ec4\u4ef6\uff0c\u8499\u5c42\u7684\u8fc7\u6e21\u662f\u5728 fade-enter-active \u4e2d\u5b9e\u73b0\u7684"),Object(a.b)("h3",{id:"\u6211\u7684\u7248\u672c"},"\u6211\u7684\u7248\u672c"),Object(a.b)("pre",null,Object(a.b)("code",Object(i.a)({parentName:"pre"},{className:"language-javascript"}),'<template>\n  <div>\n    <img\n      src="../assets/imgs/douyin.png"\n      @click="changeVisible(true)"\n      class="origin-image"\n      alt=""\n      ref="originImage"\n    />\n\n    <transition name="fade">\n      <div class="image-viewer" v-if="visible" @click="changeVisible(false)">\n        <div class="image-box">\n          <img\n            :style="imageStyle"\n            src="../assets/imgs/douyin.png"\n            class="image"\n            alt=""\n          />\n        </div>\n      </div>\n    </transition>\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      visible: false,\n      rect: {},\n      imageStyle: "",\n    };\n  },\n  methods: {\n    changeVisible(v) {\n      this.visible = v;\n      this.rect = this.$refs.originImage.getBoundingClientRect();\n      this.setImageStyle();\n    },\n    setImageStyle() {\n      // \u65b9\u6cd51\uff1a \u4f7f\u7528requestAnimationFrame\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u7684\u7f3a\u70b9\u662f\u7b2c\u4e00\u6b21\u6ca1\u6709\u8fc7\u6e21\u6548\u679c\n      // \u60f3\u4e0d\u901a\u4e3a\u4ec0\u4e48\u7528requestAnimationFrame\u4f1a\u7b2c\u4e00\u6b21\u4e0d\u6e32\u67d3\n      let raq\n      new Promise((resolve) => {\n        if (this.imageStyle) {\n          this.imageStyle = `top:${r.top}px; left: ${r.left}px;`;\n          resolve();\n        } else {\n          // \u7b2c\u4e00\u6b21\u6e32\u67d3\u65f6\u6ca1\u6709\u8fc7\u6e21\u6548\u679c\uff0c\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u554a\u3002\u3002\n          raq = window.requestAnimationFrame(() => {\n            this.imageStyle = `top:${r.top}px; left: ${r.left}px;`;\n            resolve();\n          });\n        }\n      }).then(() => {\n        raq = window.requestAnimationFrame((timestamp) => {\n          const top = (window.innerHeight - r.height) / 2;\n          const left = (window.innerWidth - r.width) / 2;\n          this.imageStyle = `width: ${r.width}px;height: ${r.height}px; top:${top}px; left: ${left}px;`;\n          if (window.requestIdleCallback) {\n            window.requestIdleCallback(() => {\n              window.cancelAnimationFrame(raq);\n            });\n          } else {\n            window.cancelAnimationFrame(raq);\n          }\n        });\n      });\n      // \u65b9\u6cd52\uff1a \u4f7f\u7528setTimeout\n      const r = this.rect;\n      this.imageStyle = `top:${r.top}px; left: ${r.left}px;`;\n      const t = setTimeout(() => {\n       const top = (window.innerHeight - r.height) / 2;\n       const left = (window.innerWidth - r.width) / 2;\n       this.imageStyle = `width: ${r.width}px;height: ${r.height}px; top:${top}px; left: ${left}px;`;\n       clearTimeout(t)\n      });\n    },\n  },\n};\n<\/script>\n\n<style scoped>\n.origin-image {\n  width: 200px;\n  height: 200px;\n  margin-left: 300px;\n  margin-top: 300px;\n}\n.image-viewer {\n  position: fixed;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  top: 0;\n  z-index: 1000;\n}\n.image-box {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  line-height: 0;\n  background-color: rgba(0, 0, 0, 0.8);\n  overflow: auto;\n}\n.image {\n  position: absolute;\n  transition: all 0.2s;\n  cursor: zoom-out;\n}\n\n.fade-enter {\n  opacity: 0;\n}\n.fade-enter-active {\n  transition: opacity 0.2s;\n}\n.fade-enter-to {\n  opacity: 1;\n}\n</style>\n')),Object(a.b)("h3",{id:"\u6548\u679c\u56fe"},"\u6548\u679c\u56fe"),Object(a.b)("img",{src:Object(o.a)("img/juejinImageViewer3.gif"),alt:""}),Object(a.b)("h3",{id:"\u601d\u8003"},"\u601d\u8003"),Object(a.b)("p",null,"\u53ef\u4ee5\u5c06\u56fe\u7247\u9884\u89c8\u62bd\u79bb\u6210\u5355\u72ec\u7ec4\u4ef6\uff0c\u4f7f\u7528\u5355\u4f8b\u6a21\u5f0f\uff0c\u4f7f\u5f97\u9875\u9762\u4e2d\u53ea\u6709\u4e00\u4e2a\u56fe\u7247\u9884\u89c8\u8282\u70b9"),Object(a.b)("h3",{id:"\u5f15\u7533\uff1a-\u6211\u60f3\u5728\u56fe\u7247\u9690\u85cf\u65f6\u6dfb\u52a0\u9006\u52a8\u753b"},"\u5f15\u7533\uff1a \u6211\u60f3\u5728\u56fe\u7247\u9690\u85cf\u65f6\u6dfb\u52a0\u9006\u52a8\u753b"),Object(a.b)("p",null,"\u89e3\u51b3\u65b9\u6848\uff1a"),Object(a.b)("ol",null,Object(a.b)("li",{parentName:"ol"},Object(a.b)("p",{parentName:"li"},"\u7b80\u5355\u66b4\u529b\uff1a \u628av-if\u6539\u6210v-show\uff0c\u7136\u540e\u5728\u9690\u85cf\u65f6\u8bbe\u7f6eimageStyle")),Object(a.b)("li",{parentName:"ol"},Object(a.b)("p",{parentName:"li"},"\u6211\u5c31\u60f3\u8981v-if\uff01"))),Object(a.b)("pre",null,Object(a.b)("code",Object(i.a)({parentName:"pre"},{className:"language-javascript"}),'<template>\n  <div>\n    <img\n      src="../assets/imgs/douyin.png"\n      @click="changeVisible(true)"\n      class="origin-image"\n      ref="originImage"\n    />\n    <transition name="fade">\n      <div class="image-viewer" v-if="visible" @click="changeVisible(false)">\n        <div class="image-box">\n          <img\n            ref="image"\n            :style="imageStyle"\n            src="../assets/imgs/douyin.png"\n            class="image"\n          />\n        </div>\n      </div>\n    </transition>\n  </div>\n</template>\n<script>\nexport default {\n  data() {\n    return {\n      visible: false,\n      rect: {},\n      imageStyle: "",\n      timeout: null,\n    };\n  },\n  methods: {\n    changeVisible(v) {\n      this.visible = v;\n      this.rect = this.$refs.originImage.getBoundingClientRect();\n      this.setImageStyle(v);\n    },\n    setImageStyle(v) {\n      const r = this.rect;\n      if (v) {\n        this.imageStyle = `top:${r.top}px; left: ${r.left}px;`;\n        this.timeout = setTimeout(() => {\n          const top = (window.innerHeight - r.height) / 2;\n          const left = (window.innerWidth - r.width) / 2;\n          this.imageStyle = `width: ${r.width}px; height: ${r.height}px; top:${top}px; left: ${left}px;`;\n        });\n      } else {\n        // \u56de\u5230\u539f\u6765\u7684\u5730\u65b9\u5c31\u884c\u4e86\n        // \u8fd9\u91cc\u4e4b\u6240\u4ee5\u4f7f\u7528ref\uff0c\u800c\u4e0d\u50cf\u539f\u6765\u90a3\u6837 this.imageStyle\uff0c\u662f\u56e0\u4e3avue\u7684\u6e32\u67d3\u673a\u5236\uff0c\n        // v-if\u4e3afalse\u65f6\uff0cimageStyle\u65e0\u6cd5\u7ed1\u5b9a\u5230\u8282\u70b9\u4e0a\n        this.$refs.image.style = `width: ${r.width}px; height: ${r.height}px; top:${r.top}px; left: ${r.left}px;`;\n      }\n    },\n  },\n  destroyed() {\n    clearTimeout(this.timeout);\n  },\n};\n<\/script>\n<style scoped>\n.origin-image {\n  width: 200px;\n  height: 200px;\n  margin-left: 300px;\n  margin-top: 300px;\n}\n.image-viewer {\n  position: fixed;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  top: 0;\n  z-index: 1000;\n}\n.image-box {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  line-height: 0;\n  background-color: rgba(0, 0, 0, 0.8);\n  overflow: auto;\n}\n.image {\n  position: absolute;\n  transition: all 0.2s;\n  cursor: zoom-out;\n}\n.fade-enter {\n  opacity: 0;\n}\n.fade-enter-active {\n  transition: opacity 0.2s;\n}\n.fade-enter-to {\n  opacity: 1;\n}\n.fade-leave {\n  opacity: 1;\n}\n.fade-leave-active {\n  transition: opacity 0.2s;\n}\n.fade-leave-to {\n  opacity: 0;\n}\n</style>\n')),Object(a.b)("img",{src:Object(o.a)("img/juejinImageViewer4.gif")}),Object(a.b)("h3",{id:"react\u7248\u672c"},"React\u7248\u672c"),Object(a.b)("pre",null,Object(a.b)("code",Object(i.a)({parentName:"pre"},{className:"language-jsx"}),"import React, { useEffect, useRef, useState } from 'react'\nimport styles from './index.module.less'\nimport { CSSTransition } from 'react-transition-group'\nimport douyinPng from '../../assets/douyin.png'\n\nconst ImageViewer = () => {\n  const [visible, setVisible] = useState(false)\n  const [rect, setRect] = useState({})\n  const [imageStyle, setImageStyle] = useState({})\n  const originImage = useRef()\n\n  const handleVisible = () => {\n    setVisible(!visible)\n    setRect(originImage.current.getBoundingClientRect())\n  }\n\n  useEffect(() => {\n    handleTransition(visible)\n  }, [visible])\n\n  const handleTransition = (visible) => {\n    if (visible) {\n      setImageStyle({\n        top: `${rect.top}px`,\n        left: `${rect.left}px`\n      })\n      const raq = window.requestAnimationFrame(() => {\n        const top = (window.innerHeight - rect.height) / 2\n        const left = (window.innerWidth - rect.width) / 2\n        setImageStyle({\n          width: `${rect.width}px`,\n          height: `${rect.height}px`,\n          top: `${top}px`,\n          left: `${left}px`\n        })\n        if (window.requestIdleCallback) {\n          window.requestIdleCallback(() => {\n            window.cancelAnimationFrame(raq);\n          });\n        } else {\n          window.cancelAnimationFrame(raq);\n        }\n      })\n    } else {\n      setImageStyle({\n        top: `${rect.top}px`,\n        left: `${rect.left}px`,\n        width: `${rect.width}px`,\n        height: `${rect.height}px`\n      })\n    }\n  }\n\n  return (\n    <>\n      <img src={douyinPng} ref={originImage} className={styles.originImage} onClick={() => handleVisible()} />\n      <CSSTransition in={visible} classNames={{\n        enter: styles['image-enter'],\n        enterActive: styles['image-enter-active'],\n        exit: styles['image-exit'],\n        exitActive: styles['image-exit-active'],\n      }} timeout={200} unmountOnExit mountOnEnter={false}>\n        <div className={styles.imageViewer}>\n          <div className={styles.imageBox} onClick={() => handleVisible()}>\n            <img src={douyinPng} style={imageStyle} className={styles.image} />\n          </div>\n        </div>\n      </CSSTransition>\n    </>\n  )\n}\n\nexport default ImageViewer\n")),Object(a.b)("pre",null,Object(a.b)("code",Object(i.a)({parentName:"pre"},{className:"language-less"}),".originImage {\n  width: 200px;\n  height: 200px;\n  margin-left: 300px;\n  margin-top: 300px;\n  cursor: zoom-in;\n}\n\n.imageViewer {\n  position: fixed;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  top: 0;\n  z-index: 1000;\n}\n\n.imageBox {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  line-height: 0;\n  background-color: rgba(0, 0, 0, 0.8);\n  overflow: auto;\n}\n\n.image {\n  position: absolute;\n  transition: all .2s;\n  cursor: zoom-out;\n}\n\n\n.image-enter {\n  opacity: 0;\n}\n\n.image-enter-active {\n  transition: opacity .2s;\n  opacity: 1;\n}\n\n\n.image-exit {\n  opacity: 1;\n}\n\n.image-exit-active {\n  transition: opacity .2s;\n  opacity: 0;\n}\n")))}p.isMDXComponent=!0}}]);